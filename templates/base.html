<!DOCTYPE html>
{% load static tailwind_tags %}


<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Site</title>
    {% tailwind_css %}
    <script>
        // Ajoute la classe dark Ã  <html> si l'utilisateur est en mode sombre
        if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.documentElement.classList.add('dark');
        }
    </script>
</head>

<body class="bg-gray-200 text-slate-900 dark:bg-slate-900 dark:text-slate-100 min-h-screen transition-colors duration-300">

    <!-- Header -->
    <header class="flex justify-end items-center p-4 bg-slate-100 text-slate-800 dark:bg-slate-800 dark:text-white shadow">
        {% if user.is_authenticated %}
            <span class="mr-2"> {{ user.username }} </span>
            <a href="{% url 'account_logout' %}" class="hover:underline">(Log out)</a>
        {% else %}
            <button onclick="openLoginPopup()" class="hover:underline">Log in</button>
            <span class="mx-1">/</span>
            <button onclick="openRegisterPopup()" class="hover:underline">Sign in</button>
        {% endif %}
    </header>

    <!-- Login Popup -->
    <div id="loginPopup" class="hidden fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50">
        <div class="bg-white dark:bg-slate-800 dark:text-slate-100 p-4 rounded shadow w-80 relative">
            <button onclick="closePopup('loginPopup')" class="absolute top-2 right-2 text-gray-500 hover:text-gray-700 dark:text-gray-300 dark:hover:text-white">&times;</button>
            <h2 class="text-lg font-semibold mb-2">Logging in</h2>
            <form method="POST" action="{% url 'account_login' %}">
                {% csrf_token %}
                {{ login_form.as_p }}
                <button type="submit" class="mt-2 px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-500">
                    Log in
                </button>
            </form>
        </div>
    </div>

    <!-- Register Popup -->
    <div id="registerPopup" class="hidden fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50">
        <div class="bg-white dark:bg-slate-800 dark:text-slate-100 p-4 rounded shadow w-80 relative">
            <button onclick="closePopup('registerPopup')" class="absolute top-2 right-2 text-gray-500 hover:text-gray-700 dark:text-gray-300 dark:hover:text-white">&times;</button>
            <h2 class="text-lg font-semibold mb-2">Signing in</h2>
            <form method="POST" action="{% url 'account_signup' %}">
                {% csrf_token %}
                {{ signup_form.as_p }}
                <button type="submit" class="mt-2 px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-500">
                    Sign in
                </button>
            </form>
        </div>
    </div>

    <!-- Main Content -->
    <main class="py-6 px-4">
        {% block content %}
        {% endblock %}
    </main>

    <!-- Popup logic -->
    <script>
    function openLoginPopup() {
        document.getElementById("loginPopup").classList.remove("hidden");
    }
    function openRegisterPopup() {
        document.getElementById("registerPopup").classList.remove("hidden");
    }
    function closePopup(popupId) {
        document.getElementById(popupId).classList.add("hidden");
    }
    </script>

</body>
</html>

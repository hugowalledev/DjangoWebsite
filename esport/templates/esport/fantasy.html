{% extends "base.html" %}

{% block content %}
<div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
  <h1 class="text-3xl font-bold text-gray-800 text-center mb-8">
    Predictions for tournament : {{ tournament.name }}
  </h1>

  <form method="post" class="space-y-8">
    {% csrf_token %}

    {% for matchday in matchdays %}
      <div class="bg-white p-6 rounded-xl shadow">
        <h2 class="text-xl font-semibold text-gray-700 mb-4">
           {{ matchday.date }} :
        </h2>

        {% for match in matchday.matches.all %}
          <div class="border-t pt-4 mt-4">
            <p class="text-lg font-medium mb-2">
              {{ match.team1.name }} vs {{ match.team2.name }}
            </p>

            <!-- Winner Prediction -->
            <div class="flex gap-4 items-center">
              <label class="inline-flex items-center gap-2">
                <input type="radio" name="winner_{{ match.id }}" value="{{ match.team1.id }}"
                  {% if predictions_by_match.match.id == match.id and predictions_by_match.match.id.predicted_winner.id == match.team1.id %}checked{% endif %}>
                {{ match.team1.name }}
              </label>
              <label class="inline-flex items-center gap-2">
                <input type="radio" name="winner_{{ match.id }}" value="{{ match.team2.id }}"
                  {% if predictions_by_match.match.id == match.id and predictions_by_match.match.id.predicted_winner.id == match.team2.id %}checked{% endif %}>
                {{ match.team2.name }}
              </label>
            </div>

            <!-- Scores -->
            <div class="mt-3 grid grid-cols-2 gap-4">
              <label class="block">
                <span calss="text-sm text-gray-600">Score vainqueur</span>
                <input type="number" name="score_winner_{{ match.id }}" min="0" class="form-input mt-1 block w-full"
                      value="{% if predictions_by_match.match.id == match.id %}{{ predictions_by_match.match.id.predicted_score_winner }}{% endif %}">
              </label>

              <label>Score perdant :
                <input type="number" name="score_loser_{{ match.id }}" min="0" class="form-input mt-1 block w-full"
                      value="{% if predictions_by_match.match.id == match.id %}{{ predictions_by_match.match.id.predicted_score_loser }}{% endif %}">
              </label>
            </div>
          </div>
        {% endfor %}

        <!-- MVP -->
        <div class="mt-6">
          <label class="block text-sm font-medium text-gray-700 mb-1">
            Today MVP :
          </label>
          <select name="fantasy_{{ matchday.id }}" class="form-select w-full" required>
            <option value="">-- Pick a player --</option>
            {% for match in matchday.matches.all %}
              {% for player in match.team1.players.all %}
                <option value="{{ player.id }}"
                  {% if fantasy_by_day.matchday.id == matchday.id and fantasy_by_day.matchday.id.id == player.id %}selected{% endif %}>
                  {{ player.name }} ({{ match.team1.name }})
                </option>
              {% endfor %}
              {% for player in match.team2.players.all %}
                <option value="{{ player.id }}"
                  {% if fantasy_by_day.matchday.id == matchday.id and fantasy_by_day.matchday.id.id == player.id %}selected{% endif %}>
                  {{ player.name }} ({{ match.team2.name }})
                </option>
              {% endfor %}
            {% endfor %}
          </select>
        </div>
      </div>
    {% endfor %}

    <div class="text-center">
      <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded-xl shadow">
        Save Predictions
      </button>
    </div>
  </form>
</div>


{% endblock %}
